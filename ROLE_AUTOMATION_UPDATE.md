# –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–æ–ª—è–º–∏ –ø—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –∑–∞—è–≤–ª–µ–Ω–∏–π

## –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–æ–ª—è–º–∏ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π –∏ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π –ø—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –∑–∞—è–≤–ª–µ–Ω–∏–π –≤ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è.

## –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–æ–ª—è–º–∏ –ø—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏
–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ "–û–¥–æ–±—Ä–∏—Ç—å" —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- **–£–¥–∞–ª—è–µ—Ç –í–°–ï —Ä–æ–ª–∏ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π** —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ç–∏–ø–∞ –∑–∞—è–≤–ª–µ–Ω–∏—è - –ø–µ—Ä–µ–≤–æ–¥ –∏–ª–∏ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ)
- **–£–¥–∞–ª—è–µ—Ç –í–°–ï —Ä–æ–ª–∏ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π** —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 
- **–í—ã–¥–∞–µ—Ç —Ä–æ–ª—å –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è**
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–¥–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ "–≤—ã–¥–∞–≤–∞–µ–º—ã–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏"** –¥–ª—è –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
- **–û–±–Ω–æ–≤–ª—è–µ—Ç –Ω–∏–∫–Ω–µ–π–º** —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è

### 2. –ù–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–æ–ª–µ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π
–í `/settings` ‚Üí "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞–Ω–∞–ª–æ–≤" ‚Üí "–ó–∞—è–≤–ª–µ–Ω–∏—è –≤ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è" –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–≤–µ –Ω–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏:

#### üéñÔ∏è –†–æ–ª–∏ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π (–≤—Å–µ)
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ä–æ–ª–µ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è **—É–¥–∞–ª–µ–Ω–∏—è** –ø—Ä–∏ –ø–µ—Ä–µ–≤–æ–¥–∞—Ö/–≤—Å—Ç—É–ø–ª–µ–Ω–∏—è—Ö
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ —Å–ø–∏—Å–∫–æ–º —Ä–æ–ª–µ–π

#### ‚≠ê –í—ã–¥–∞–≤–∞–µ–º—ã–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏  
- –†–æ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–¥–∞—é—Ç—Å—è** –Ω–æ–≤–∏—á–∫–∞–º –ø—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –∑–∞—è–≤–ª–µ–Ω–∏—è
- –ü–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤—Å–µ—Ö —Ä–æ–ª–µ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –ø–æ–ª—è –≤ `config.json` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è:

```json
{
  "departments": {
    "–£–í–ü": {
      "role_id": 1234567890,
      "position_role_ids": [1111111111, 2222222222, 3333333333],
      "assignable_position_role_ids": [1111111111]
    }
  }
}
```

- `position_role_ids` - –≤—Å–µ —Ä–æ–ª–∏ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è (–¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è)
- `assignable_position_role_ids` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–¥–∞–≤–∞–µ–º—ã–µ —Ä–æ–ª–∏ (–¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤)

## –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. `utils/ping_manager.py`
- `get_all_department_role_ids()` - –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ä–æ–ª–∏ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π
- `get_all_position_role_ids()` - –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ä–æ–ª–∏ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π  
- `get_department_position_roles()` - —Ä–æ–ª–∏ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è
- `get_department_assignable_position_roles()` - –≤—ã–¥–∞–≤–∞–µ–º—ã–µ —Ä–æ–ª–∏ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è

### 2. `forms/department_applications/views.py`
- **–û–±–Ω–æ–≤–ª–µ–Ω `_process_approval()`** - –Ω–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–æ–ª—è–º–∏
- **–î–æ–±–∞–≤–ª–µ–Ω `_remove_all_department_roles()`** - —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–æ–ª–µ–π –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π
- **–î–æ–±–∞–≤–ª–µ–Ω `_remove_all_position_roles()`** - —É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–æ–ª–µ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π
- **–î–æ–±–∞–≤–ª–µ–Ω `_assign_department_position_roles()`** - –≤—ã–¥–∞—á–∞ –≤—ã–¥–∞–≤–∞–µ–º—ã—Ö –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π

### 3. `forms/settings/channels_departments.py`
- **–î–æ–±–∞–≤–ª–µ–Ω—ã –∫–Ω–æ–ø–∫–∏** –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–æ–ª–µ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π
- **`DepartmentPositionRolesModal`** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Å–µ—Ö —Ä–æ–ª–µ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π
- **`DepartmentAssignablePositionsModal`** - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—ã–¥–∞–≤–∞–µ–º—ã—Ö –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π
- **–û–±–Ω–æ–≤–ª–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å** –ø–æ–∫–∞–∑–∞ —Ç–µ–∫—É—â–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫

### 4. `forms/settings/base.py`
- **–î–æ–±–∞–≤–ª–µ–Ω—ã –º–µ—Ç–æ–¥—ã `parse_role()` –∏ `parse_channel()`** –≤ `BaseSettingsModal`

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ü—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏ –∑–∞—è–≤–ª–µ–Ω–∏—è:
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞** (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
2. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–æ–ª–∏ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è** (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)  
3. **üÜï –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–æ–ª–µ–π –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π** (–≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –≤ —Å–∏—Å—Ç–µ–º–µ)
4. **üÜï –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–æ–ª–µ–π –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π** (–≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –≤ —Å–∏—Å—Ç–µ–º–µ)
5. **–í—ã–¥–∞—á–∞ —Ä–æ–ª–∏ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è** (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
6. **üÜï –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤—ã–¥–∞—á–∞ –≤—ã–¥–∞–≤–∞–µ–º—ã—Ö –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π**
7. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∏–∫–Ω–µ–π–º–∞** (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:
- –ï—Å–ª–∏ –Ω–µ—Ç –ø—Ä–∞–≤ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ/–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ä–æ–ª–∏ - –º–æ–ª—á–∞ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è
- –õ–æ–≥–∏—Ä—É—é—Ç—Å—è —É—Å–ø–µ—à–Ω—ã–µ –∏ –Ω–µ—É–¥–∞—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å —Ä–æ–ª—è–º–∏
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

1. **–ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞–º –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é —É–ø—Ä–∞–≤–ª—è—Ç—å —Ä–æ–ª—è–º–∏
2. **–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ª—é–±—ã—Ö –∑–∞—è–≤–ª–µ–Ω–∏–π (–≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ/–ø–µ—Ä–µ–≤–æ–¥)
3. **–ì–∏–±–∫–æ—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏** - –∫–∞–∂–¥–æ–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
5. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å —Ä–æ–ª—è–º–∏

## –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥–∞–µ—Ç –∑–∞—è–≤–ª–µ–Ω–∏–µ –≤ –£–í–ü
2. –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –æ–¥–æ–±—Ä—è–µ—Ç ‚Üí —Ä–æ–ª—å –£–í–ü + –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–µ—Ä–µ–≤–æ–¥ –º–µ–∂–¥—É –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è–º–∏  
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—Å–æ—Å—Ç–æ–∏—Ç –≤ –í–ö) –ø–æ–¥–∞–µ—Ç –∑–∞—è–≤–ª–µ–Ω–∏–µ –Ω–∞ –ø–µ—Ä–µ–≤–æ–¥ –≤ –£–í–ü
2. –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä –æ–¥–æ–±—Ä—è–µ—Ç ‚Üí —É–¥–∞–ª—è—é—Ç—Å—è —Ä–æ–ª–∏ –í–ö –∏ –≤—Å–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ ‚Üí –≤—ã–¥–∞—é—Ç—Å—è —Ä–æ–ª—å –£–í–ü + –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –£–í–ü

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–æ–ª–µ–π
1. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∑–∞—Ö–æ–¥–∏—Ç –≤ `/settings` ‚Üí "–ó–∞—è–≤–ª–µ–Ω–∏—è –≤ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è" ‚Üí –≤—ã–±–∏—Ä–∞–µ—Ç –£–í–ü
2. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç "–†–æ–ª–∏ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π (–≤—Å–µ)": @–†—è–¥–æ–≤–æ–π, @–ï—Ñ—Ä–µ–π—Ç–æ—Ä, @–ú–ª–∞–¥—à–∏–π —Å–µ—Ä–∂–∞–Ω—Ç
3. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç "–í—ã–¥–∞–≤–∞–µ–º—ã–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏": @–†—è–¥–æ–≤–æ–π  
4. –¢–µ–ø–µ—Ä—å –≤—Å–µ–º –Ω–æ–≤–∏—á–∫–∞–º –≤ –£–í–ü –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–¥–∞–µ—Ç—Å—è —Ä–æ–ª—å @–†—è–¥–æ–≤–æ–π

## –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –ø–æ–ª–Ω–∞—è –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- ‚úÖ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å  
- ‚úÖ –°—Ç–∞—Ä—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (`key_role_id`) –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è
- ‚úÖ –ï—Å–ª–∏ —Ä–æ–ª–∏ –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã - —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
